<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Scientisst: scientisst.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Scientisst
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scientisst.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Main file for the Scientisst firmware.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="scientisst_8h_source.html">scientisst.h</a>&quot;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="adc_8h_source.html">adc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ble_8h_source.html">ble.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="bt_8h_source.html">bt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="com_8h_source.html">com.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="gpio_8h_source.html">gpio.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="i2c_8h_source.html">i2c.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="macros_8h_source.html">macros.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="macros__conf_8h_source.html">macros_conf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sd__card_8h_source.html">sd_card.h</a>&quot;</code><br />
<code>#include &quot;sdkconfig.h&quot;</code><br />
<code>#include &quot;<a class="el" href="spi_8h_source.html">spi.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tcp_8h_source.html">tcp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timer_8h_source.html">timer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="uart_8h_source.html">uart.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="udp_8h_source.html">udp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="wifi_8h_source.html">wifi.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="wifi__rest__server_8h_source.html">wifi_rest_server.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ws_8h_source.html">ws.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for scientisst.c:</div>
<div class="dyncontent">
<div class="center"><img src="scientisst_8c__incl.png" border="0" usemap="#ascientisst_8c" alt=""/></div>
<map name="ascientisst_8c" id="ascientisst_8c">
<area shape="rect" title="Main file for the Scientisst firmware." alt="" coords="2965,5,3059,32"/>
<area shape="rect" href="scientisst_8h.html" title="Main header file for the Scientisst firmware." alt="" coords="1463,80,1559,107"/>
<area shape="rect" href="com_8h.html" title="This file contains the definitions of the functions used to process the received data." alt="" coords="173,155,235,181"/>
<area shape="rect" title=" " alt="" coords="5,229,101,256"/>
<area shape="rect" href="wifi_8h.html" title="Wifi functions definitions and relevant defines." alt="" coords="91,155,149,181"/>
<area shape="rect" title=" " alt="" coords="1370,80,1438,107"/>
<area shape="rect" href="adc_8h.html" title="ADC interactions header file." alt="" coords="2694,80,2751,107"/>
<area shape="rect" href="spi_8h.html" title="This file contains the definitions of the functions used to communicate with the external ADCs." alt="" coords="2965,155,3019,181"/>
<area shape="rect" href="macros__conf_8h.html" title="Hidden macros for configuration file." alt="" coords="3291,304,3407,331"/>
<area shape="rect" href="ble_8h.html" title="BLE mode functions header file." alt="" coords="2883,80,2938,107"/>
<area shape="rect" href="bt_8h.html" title="Bluetooth header file." alt="" coords="3185,80,3231,107"/>
<area shape="rect" href="gpio_8h.html" title="GPIO interactions." alt="" coords="3462,155,3525,181"/>
<area shape="rect" href="i2c_8h.html" title="This file contains the definitions of the functions used to communicate with the e&#45;covid sensor." alt="" coords="3107,80,3160,107"/>
<area shape="rect" href="macros_8h.html" title="This file contains the definitions of the macros used in the project." alt="" coords="2776,80,2859,107"/>
<area shape="rect" href="sd__card_8h.html" title="SD card driver. This file implements the SD card driver." alt="" coords="3418,80,3502,107"/>
<area shape="rect" href="tcp_8h.html" title="Header file for the TCP server and client functions." alt="" coords="3255,80,3310,107"/>
<area shape="rect" href="timer_8h.html" title="Timer functions for the Scientisst firmware." alt="" coords="3014,80,3082,107"/>
<area shape="rect" href="uart_8h.html" title="Header file for uart.c." alt="" coords="3526,80,3586,107"/>
<area shape="rect" href="udp_8h.html" title="UDP client functions." alt="" coords="3335,80,3393,107"/>
<area shape="rect" href="wifi__rest__server_8h.html" title="Header file for wifi_rest_server.c." alt="" coords="3661,80,3797,107"/>
<area shape="rect" href="ws_8h.html" title="Websocket server." alt="" coords="254,80,306,107"/>
<area shape="rect" title=" " alt="" coords="468,155,551,181"/>
<area shape="rect" title=" " alt="" coords="182,229,253,256"/>
<area shape="rect" title=" " alt="" coords="3029,229,3096,256"/>
<area shape="rect" title=" " alt="" coords="575,155,646,181"/>
<area shape="rect" title=" " alt="" coords="2585,155,2658,181"/>
<area shape="rect" title=" " alt="" coords="2572,229,2719,256"/>
<area shape="rect" title=" " alt="" coords="670,155,781,181"/>
<area shape="rect" title=" " alt="" coords="2447,155,2561,181"/>
<area shape="rect" title=" " alt="" coords="805,155,931,181"/>
<area shape="rect" title=" " alt="" coords="956,155,1073,181"/>
<area shape="rect" title=" " alt="" coords="1098,155,1233,181"/>
<area shape="rect" title=" " alt="" coords="2806,155,2890,181"/>
<area shape="rect" title=" " alt="" coords="1257,155,1351,181"/>
<area shape="rect" title=" " alt="" coords="1375,155,1489,181"/>
<area shape="rect" title=" " alt="" coords="1514,155,1665,181"/>
<area shape="rect" title=" " alt="" coords="1689,155,1826,181"/>
<area shape="rect" title=" " alt="" coords="1851,155,1968,181"/>
<area shape="rect" title=" " alt="" coords="1993,155,2050,181"/>
<area shape="rect" title=" " alt="" coords="2074,155,2169,181"/>
<area shape="rect" title=" " alt="" coords="2193,155,2284,181"/>
<area shape="rect" title=" " alt="" coords="2308,155,2372,181"/>
<area shape="rect" href="version_8h.html" title="Auto&#45;generated file containing the firmware version number." alt="" coords="361,155,444,181"/>
<area shape="rect" title=" " alt="" coords="2683,155,2781,181"/>
<area shape="rect" href="config_8h.html" title="Configuration file." alt="" coords="3214,229,3287,256"/>
<area shape="rect" title=" " alt="" coords="3246,155,3327,181"/>
<area shape="rect" title=" " alt="" coords="3351,155,3438,181"/>
<area shape="rect" title=" " alt="" coords="3312,229,3411,256"/>
<area shape="rect" title=" " alt="" coords="3485,229,3589,256"/>
<area shape="rect" title=" " alt="" coords="3614,229,3717,256"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a39c04b009ae40c9fc561f6d192ae24d4"><td class="memItemLeft" align="right" valign="top"><a id="a39c04b009ae40c9fc561f6d192ae24d4" name="a39c04b009ae40c9fc561f6d192ae24d4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BT_SEND_PRIORITY</b>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a39c04b009ae40c9fc561f6d192ae24d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bcf86be2438d93d8b2504a4b837979c"><td class="memItemLeft" align="right" valign="top"><a id="a8bcf86be2438d93d8b2504a4b837979c" name="a8bcf86be2438d93d8b2504a4b837979c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ABAT_PRIORITY</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a8bcf86be2438d93d8b2504a4b837979c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1370089b0de340a69a3529d93630484e"><td class="memItemLeft" align="right" valign="top"><a id="a1370089b0de340a69a3529d93630484e" name="a1370089b0de340a69a3529d93630484e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>WIFI_RCV_PRIORITY</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a1370089b0de340a69a3529d93630484e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2da96036df526ff366c30f1c42145c45"><td class="memItemLeft" align="right" valign="top"><a id="a2da96036df526ff366c30f1c42145c45" name="a2da96036df526ff366c30f1c42145c45"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ACQ_ADC1_PRIORITY</b>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a2da96036df526ff366c30f1c42145c45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a7d1640cbc3a7a1de67d2684ab18a47"><td class="memItemLeft" align="right" valign="top"><a id="a2a7d1640cbc3a7a1de67d2684ab18a47" name="a2a7d1640cbc3a7a1de67d2684ab18a47"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ACQ_ADC_EXT_PRIORITY</b>&#160;&#160;&#160;11</td></tr>
<tr class="separator:a2a7d1640cbc3a7a1de67d2684ab18a47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af8d99f5f9f4ad067020fb6e4f3157c66"><td class="memItemLeft" align="right" valign="top">void IRAM_ATTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#af8d99f5f9f4ad067020fb6e4f3157c66">sendTask</a> (void)</td></tr>
<tr class="memdesc:af8d99f5f9f4ad067020fb6e4f3157c66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task that sends data to the client.  <a href="scientisst_8c.html#af8d99f5f9f4ad067020fb6e4f3157c66">More...</a><br /></td></tr>
<tr class="separator:af8d99f5f9f4ad067020fb6e4f3157c66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65b2d1da040aa03eb6bc55ff6495ea2f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#a65b2d1da040aa03eb6bc55ff6495ea2f">rcvTask</a> (void)</td></tr>
<tr class="memdesc:a65b2d1da040aa03eb6bc55ff6495ea2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task that receives data from the client.  <a href="scientisst_8c.html#a65b2d1da040aa03eb6bc55ff6495ea2f">More...</a><br /></td></tr>
<tr class="separator:a65b2d1da040aa03eb6bc55ff6495ea2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d9b367cc11624243590cb4e706cc891"><td class="memItemLeft" align="right" valign="top">void IRAM_ATTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#a0d9b367cc11624243590cb4e706cc891">AbatTask</a> (void)</td></tr>
<tr class="memdesc:a0d9b367cc11624243590cb4e706cc891"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task that acquires data from adcExt.  <a href="scientisst_8c.html#a0d9b367cc11624243590cb4e706cc891">More...</a><br /></td></tr>
<tr class="separator:a0d9b367cc11624243590cb4e706cc891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74b98e4514cbc17bc5f80e463872af67"><td class="memItemLeft" align="right" valign="top">void IRAM_ATTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#a74b98e4514cbc17bc5f80e463872af67">acqAdc1Task</a> (void)</td></tr>
<tr class="memdesc:a74b98e4514cbc17bc5f80e463872af67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task that acquires data from adc1.  <a href="scientisst_8c.html#a74b98e4514cbc17bc5f80e463872af67">More...</a><br /></td></tr>
<tr class="separator:a74b98e4514cbc17bc5f80e463872af67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca145e7c1142fb0bf52df7792421675d"><td class="memItemLeft" align="right" valign="top"><a id="aca145e7c1142fb0bf52df7792421675d" name="aca145e7c1142fb0bf52df7792421675d"></a>
void IRAM_ATTR&#160;</td><td class="memItemRight" valign="bottom"><b>acqAdcExtTask</b> (void)</td></tr>
<tr class="separator:aca145e7c1142fb0bf52df7792421675d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaef0ef3b74ab2d2e8e833c961fdade79"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#aaef0ef3b74ab2d2e8e833c961fdade79">opModeConfig</a> (void)</td></tr>
<tr class="memdesc:aaef0ef3b74ab2d2e8e833c961fdade79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Puts the device in config mode.  <a href="scientisst_8c.html#aaef0ef3b74ab2d2e8e833c961fdade79">More...</a><br /></td></tr>
<tr class="separator:aaef0ef3b74ab2d2e8e833c961fdade79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67371293d974b9087bcb16643de878f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#a67371293d974b9087bcb16643de878f0">initScientisst</a> (void)</td></tr>
<tr class="memdesc:a67371293d974b9087bcb16643de878f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">scientisst-firmware main function  <a href="scientisst_8c.html#a67371293d974b9087bcb16643de878f0">More...</a><br /></td></tr>
<tr class="separator:a67371293d974b9087bcb16643de878f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a19e62782c492aeba9e3304a4312d222a"><td class="memItemLeft" align="right" valign="top"><a id="a19e62782c492aeba9e3304a4312d222a" name="a19e62782c492aeba9e3304a4312d222a"></a>
TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>send_task</b></td></tr>
<tr class="separator:a19e62782c492aeba9e3304a4312d222a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fe8dff9b6854a628097650435e9dfe9"><td class="memItemLeft" align="right" valign="top"><a id="a5fe8dff9b6854a628097650435e9dfe9" name="a5fe8dff9b6854a628097650435e9dfe9"></a>
TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>abat_task</b></td></tr>
<tr class="separator:a5fe8dff9b6854a628097650435e9dfe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a571f93394be93268e6c09c1fedf548f1"><td class="memItemLeft" align="right" valign="top"><a id="a571f93394be93268e6c09c1fedf548f1" name="a571f93394be93268e6c09c1fedf548f1"></a>
TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>rcv_task</b></td></tr>
<tr class="separator:a571f93394be93268e6c09c1fedf548f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ca7559f4e9fd35d6cd5dba106c707a2"><td class="memItemLeft" align="right" valign="top"><a id="a3ca7559f4e9fd35d6cd5dba106c707a2" name="a3ca7559f4e9fd35d6cd5dba106c707a2"></a>
TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>acq_adc1_task</b></td></tr>
<tr class="separator:a3ca7559f4e9fd35d6cd5dba106c707a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3beecfd9909f92fdd031c31132f8b68"><td class="memItemLeft" align="right" valign="top"><a id="ac3beecfd9909f92fdd031c31132f8b68" name="ac3beecfd9909f92fdd031c31132f8b68"></a>
TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>acq_adc_ext_task</b></td></tr>
<tr class="separator:ac3beecfd9909f92fdd031c31132f8b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a559e662c57addba866d0503d53160930"><td class="memItemLeft" align="right" valign="top"><a id="a559e662c57addba866d0503d53160930" name="a559e662c57addba866d0503d53160930"></a>
SemaphoreHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>bt_buffs_to_send_mutex</b></td></tr>
<tr class="separator:a559e662c57addba866d0503d53160930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaff1451b6194ff105801c35d7fbcfd4"><td class="memItemLeft" align="right" valign="top"><a id="abaff1451b6194ff105801c35d7fbcfd4" name="abaff1451b6194ff105801c35d7fbcfd4"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>device_name</b> [17] = BT_DEFAULT_DEVICE_NAME</td></tr>
<tr class="separator:abaff1451b6194ff105801c35d7fbcfd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ccd8921f38d8d73068731023f739eac"><td class="memItemLeft" align="right" valign="top"><a id="a4ccd8921f38d8d73068731023f739eac" name="a4ccd8921f38d8d73068731023f739eac"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>send_fd</b> = 0</td></tr>
<tr class="separator:a4ccd8921f38d8d73068731023f739eac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdb26d185e6ca000ec9ef9b36c5696ac"><td class="memItemLeft" align="right" valign="top"><a id="afdb26d185e6ca000ec9ef9b36c5696ac" name="afdb26d185e6ca000ec9ef9b36c5696ac"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>listen_fd</b> = 0</td></tr>
<tr class="separator:afdb26d185e6ca000ec9ef9b36c5696ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2b4deaf1aa96b3b76c622733874f9ef"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#ac2b4deaf1aa96b3b76c622733874f9ef">snd_buff</a> [NUM_BUFFERS]</td></tr>
<tr class="separator:ac2b4deaf1aa96b3b76c622733874f9ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3c5bd8b98f34726adca0d5d4496d5ee"><td class="memItemLeft" align="right" valign="top"><a id="aa3c5bd8b98f34726adca0d5d4496d5ee" name="aa3c5bd8b98f34726adca0d5d4496d5ee"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><b>send_buff_len</b> = 0</td></tr>
<tr class="memdesc:aa3c5bd8b98f34726adca0d5d4496d5ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Length of each send buff. <br /></td></tr>
<tr class="separator:aa3c5bd8b98f34726adca0d5d4496d5ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb1e90d26548b840cbbae672eb63c0d7"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#abb1e90d26548b840cbbae672eb63c0d7">snd_buff_idx</a> [NUM_BUFFERS]</td></tr>
<tr class="separator:abb1e90d26548b840cbbae672eb63c0d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfaf9589d576b3fc0786f581b20bc19e"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#acfaf9589d576b3fc0786f581b20bc19e">bt_buffs_to_send</a> [NUM_BUFFERS]</td></tr>
<tr class="separator:acfaf9589d576b3fc0786f581b20bc19e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8607928ef2ef25e6de81c163efc5f806"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#a8607928ef2ef25e6de81c163efc5f806">bt_curr_buff</a></td></tr>
<tr class="memdesc:a8607928ef2ef25e6de81c163efc5f806"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index of the buffer that bt task is currently sending.  <a href="scientisst_8c.html#a8607928ef2ef25e6de81c163efc5f806">More...</a><br /></td></tr>
<tr class="separator:a8607928ef2ef25e6de81c163efc5f806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf58f1ea0e678533fafefedcba16ce39"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#adf58f1ea0e678533fafefedcba16ce39">acq_curr_buff</a></td></tr>
<tr class="memdesc:adf58f1ea0e678533fafefedcba16ce39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index of the buffer that adc task is currently using.  <a href="scientisst_8c.html#adf58f1ea0e678533fafefedcba16ce39">More...</a><br /></td></tr>
<tr class="separator:adf58f1ea0e678533fafefedcba16ce39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee3ef59ff651fe7e6a9c273affdd5d5a"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#aee3ef59ff651fe7e6a9c273affdd5d5a">packet_size</a></td></tr>
<tr class="memdesc:aee3ef59ff651fe7e6a9c273affdd5d5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current packet size (dependent on number of channels used)  <a href="scientisst_8c.html#aee3ef59ff651fe7e6a9c273affdd5d5a">More...</a><br /></td></tr>
<tr class="separator:aee3ef59ff651fe7e6a9c273affdd5d5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a5410ab9ad2ae9325099b2315faf334"><td class="memItemLeft" align="right" valign="top"><a id="a5a5410ab9ad2ae9325099b2315faf334" name="a5a5410ab9ad2ae9325099b2315faf334"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>send_busy</b> = 0</td></tr>
<tr class="separator:a5a5410ab9ad2ae9325099b2315faf334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba2be5e3b1baddd09080812b975bf2fc"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#aba2be5e3b1baddd09080812b975bf2fc">send_threshold</a></td></tr>
<tr class="separator:aba2be5e3b1baddd09080812b975bf2fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a649e81573a3aad33548e7f8c21700ada"><td class="memItemLeft" align="right" valign="top">DRAM_ATTR const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#a649e81573a3aad33548e7f8c21700ada">crc_table</a> [16]</td></tr>
<tr class="separator:a649e81573a3aad33548e7f8c21700ada"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30ce041a03a995813db2cc992f965f27"><td class="memItemLeft" align="right" valign="top"><a id="a30ce041a03a995813db2cc992f965f27" name="a30ce041a03a995813db2cc992f965f27"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>crc_seq</b> = 0</td></tr>
<tr class="separator:a30ce041a03a995813db2cc992f965f27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a884fc7df05c9eaf5001d47dc09cc7194"><td class="memItemLeft" align="right" valign="top"><a id="a884fc7df05c9eaf5001d47dc09cc7194" name="a884fc7df05c9eaf5001d47dc09cc7194"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>battery_threshold</b> = <a class="el" href="adc_8h.html#ace491076e4abfca2474f6a281bc85940">DEFAULT_BATTERY_THRESHOLD</a></td></tr>
<tr class="separator:a884fc7df05c9eaf5001d47dc09cc7194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6369df7f65a4b328aa3de63c2f6be78"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structApi__Config.html">Api_Config</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#ae6369df7f65a4b328aa3de63c2f6be78">api_config</a></td></tr>
<tr class="separator:ae6369df7f65a4b328aa3de63c2f6be78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65f742e8d4496f2431894fafe695cc53"><td class="memItemLeft" align="right" valign="top"><a id="a65f742e8d4496f2431894fafe695cc53" name="a65f742e8d4496f2431894fafe695cc53"></a>
cJSON *&#160;</td><td class="memItemRight" valign="bottom"><b>json</b> = NULL</td></tr>
<tr class="separator:a65f742e8d4496f2431894fafe695cc53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a310c92dadfc8850f5c31ed6fd5dbf3d4"><td class="memItemLeft" align="right" valign="top"><a id="a310c92dadfc8850f5c31ed6fd5dbf3d4" name="a310c92dadfc8850f5c31ed6fd5dbf3d4"></a>
esp_err_t(*&#160;</td><td class="memItemRight" valign="bottom"><b>send_func</b> )(uint32_t, int, uint8_t *) = NULL</td></tr>
<tr class="memdesc:a310c92dadfc8850f5c31ed6fd5dbf3d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send function pointer. <br /></td></tr>
<tr class="separator:a310c92dadfc8850f5c31ed6fd5dbf3d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f17a0b46a4710620873bdfc4bfb8f5c"><td class="memItemLeft" align="right" valign="top">DRAM_ATTR const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#a4f17a0b46a4710620873bdfc4bfb8f5c">analog_channels</a> [DEFAULT_ADC_CHANNELS]</td></tr>
<tr class="separator:a4f17a0b46a4710620873bdfc4bfb8f5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a07a97b62df36dc9cd67e6a56bb00b2"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#a3a07a97b62df36dc9cd67e6a56bb00b2">active_internal_chs</a> [DEFAULT_ADC_CHANNELS]</td></tr>
<tr class="separator:a3a07a97b62df36dc9cd67e6a56bb00b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa96057547878820ef99184651491fa49"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#aa96057547878820ef99184651491fa49">active_ext_chs</a> [EXT_ADC_CHANNELS]</td></tr>
<tr class="memdesc:aa96057547878820ef99184651491fa49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Active external channels | If all channels are active: = {7, 6}.  <a href="scientisst_8c.html#aa96057547878820ef99184651491fa49">More...</a><br /></td></tr>
<tr class="separator:aa96057547878820ef99184651491fa49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae18476f0aa11096ed565a85ebfc90507"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#ae18476f0aa11096ed565a85ebfc90507">adc_ext_samples</a> [EXT_ADC_CHANNELS]</td></tr>
<tr class="separator:ae18476f0aa11096ed565a85ebfc90507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42d56683542bef172366ecb20446ef54"><td class="memItemLeft" align="right" valign="top"><a id="a42d56683542bef172366ecb20446ef54" name="a42d56683542bef172366ecb20446ef54"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>num_intern_active_chs</b> = 0</td></tr>
<tr class="separator:a42d56683542bef172366ecb20446ef54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fceb86dcc2db967ea153357ac554190"><td class="memItemLeft" align="right" valign="top"><a id="a3fceb86dcc2db967ea153357ac554190" name="a3fceb86dcc2db967ea153357ac554190"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>num_extern_active_chs</b> = 0</td></tr>
<tr class="separator:a3fceb86dcc2db967ea153357ac554190"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec948fb30e99b1eda7e3d9ff741d417a"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#aec948fb30e99b1eda7e3d9ff741d417a">op_mode</a> = OP_MODE_IDLE</td></tr>
<tr class="separator:aec948fb30e99b1eda7e3d9ff741d417a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fba55d9442e7dba4623825cd737e520"><td class="memItemLeft" align="right" valign="top"><a id="a2fba55d9442e7dba4623825cd737e520" name="a2fba55d9442e7dba4623825cd737e520"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><b>sample_rate</b> = DEFAULT_SAMPLE_RATE</td></tr>
<tr class="separator:a2fba55d9442e7dba4623825cd737e520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fad2ab5c7e2add7ca0a5aa441872762"><td class="memItemLeft" align="right" valign="top"><a id="a8fad2ab5c7e2add7ca0a5aa441872762" name="a8fad2ab5c7e2add7ca0a5aa441872762"></a>
esp_adc_cal_characteristics_t&#160;</td><td class="memItemRight" valign="bottom"><b>adc1_chars</b></td></tr>
<tr class="separator:a8fad2ab5c7e2add7ca0a5aa441872762"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe025b99b3111cc4a2f1d9b33f963504"><td class="memItemLeft" align="right" valign="top"><a id="abe025b99b3111cc4a2f1d9b33f963504" name="abe025b99b3111cc4a2f1d9b33f963504"></a>
esp_adc_cal_characteristics_t&#160;</td><td class="memItemRight" valign="bottom"><b>adc2_chars</b></td></tr>
<tr class="separator:abe025b99b3111cc4a2f1d9b33f963504"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e8a9bc55469d1a4dc97d6c6e86fd81"><td class="memItemLeft" align="right" valign="top"><a id="aa0e8a9bc55469d1a4dc97d6c6e86fd81" name="aa0e8a9bc55469d1a4dc97d6c6e86fd81"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>gpio_out_state</b> [2] = {0, 0}</td></tr>
<tr class="memdesc:aa0e8a9bc55469d1a4dc97d6c6e86fd81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output of 01 &amp; O2 (O0 &amp; O1) <br /></td></tr>
<tr class="separator:aa0e8a9bc55469d1a4dc97d6c6e86fd81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a677980e26e55da72e6d7091450572300"><td class="memItemLeft" align="right" valign="top"><a id="a677980e26e55da72e6d7091450572300" name="a677980e26e55da72e6d7091450572300"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><b>ext_adc_raw_data</b> [3]</td></tr>
<tr class="memdesc:a677980e26e55da72e6d7091450572300"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raw data from external adc. <br /></td></tr>
<tr class="separator:a677980e26e55da72e6d7091450572300"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00b1975a55c7817b061a797e43c45aff"><td class="memItemLeft" align="right" valign="top">const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#a00b1975a55c7817b061a797e43c45aff">sin10Hz</a> [100]</td></tr>
<tr class="separator:a00b1975a55c7817b061a797e43c45aff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7140e27a5abc7a2b038347434f0374e"><td class="memItemLeft" align="right" valign="top"><a id="ae7140e27a5abc7a2b038347434f0374e" name="ae7140e27a5abc7a2b038347434f0374e"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>sim_flag</b> = 0</td></tr>
<tr class="separator:ae7140e27a5abc7a2b038347434f0374e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bbddce911432732664074cf4c252288"><td class="memItemLeft" align="right" valign="top"><a id="a1bbddce911432732664074cf4c252288" name="a1bbddce911432732664074cf4c252288"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>sin_i</b> = 0</td></tr>
<tr class="separator:a1bbddce911432732664074cf4c252288"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7026e7526fc83dfe44240b66b2b957c1"><td class="memItemLeft" align="right" valign="top"><a id="a7026e7526fc83dfe44240b66b2b957c1" name="a7026e7526fc83dfe44240b66b2b957c1"></a>
spi_device_handle_t&#160;</td><td class="memItemRight" valign="bottom"><b>adc_ext_spi_handler</b></td></tr>
<tr class="separator:a7026e7526fc83dfe44240b66b2b957c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d6caeccf40e673721eb7ce26f033531"><td class="memItemLeft" align="right" valign="top"><a id="a9d6caeccf40e673721eb7ce26f033531" name="a9d6caeccf40e673721eb7ce26f033531"></a>
spi_transaction_t&#160;</td><td class="memItemRight" valign="bottom"><b>adc_ext_trans</b></td></tr>
<tr class="separator:a9d6caeccf40e673721eb7ce26f033531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad24c7510f51acaac27b62d21c280b747"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structop__settings__info__t.html">op_settings_info_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#ad24c7510f51acaac27b62d21c280b747">op_settings</a></td></tr>
<tr class="separator:ad24c7510f51acaac27b62d21c280b747"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a304133f917e93ba96a348df51387dc92"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scientisst_8c.html#a304133f917e93ba96a348df51387dc92">is_op_settings_valid</a> = 0</td></tr>
<tr class="separator:a304133f917e93ba96a348df51387dc92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38cf39cf8c11960d72d032bf96426547"><td class="memItemLeft" align="right" valign="top"><a id="a38cf39cf8c11960d72d032bf96426547" name="a38cf39cf8c11960d72d032bf96426547"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>first_failed_send</b> = 0</td></tr>
<tr class="separator:a38cf39cf8c11960d72d032bf96426547"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Main file for the Scientisst firmware. </p>
<p >This file is the main file for the Scientisst firmware. It handles the initialization of the firmware and the creation of the tasks. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0d9b367cc11624243590cb4e706cc891" name="a0d9b367cc11624243590cb4e706cc891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d9b367cc11624243590cb4e706cc891">&#9670;&nbsp;</a></span>AbatTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IRAM_ATTR AbatTask </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task that acquires data from adcExt. </p>
<p >This task is responsible for acquiring data from adcExt. It is notified by the timerGrp1Isr when to acquire data. It notifies the sendTask when there is data to send. It is also the main task of CPU0 (PRO CPU)</p>
<p >Task that acquires data from adc2 (battery).</p>
<p >This task is responsible for acquiring data from adc2 (battery). It is notified by the timerGrp1Isr when to acquire data. It notifies the sendTask when there is data to send. It is also the main task of CPU0 (PRO CPU) </p>

</div>
</div>
<a id="a74b98e4514cbc17bc5f80e463872af67" name="a74b98e4514cbc17bc5f80e463872af67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74b98e4514cbc17bc5f80e463872af67">&#9670;&nbsp;</a></span>acqAdc1Task()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IRAM_ATTR acqAdc1Task </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task that acquires data from adc1. </p>
<p >This task is responsible for acquiring data from adc1. It is notified by the timerGrp0Isr when to acquire data. It notifies the sendTask when there is data to send. It is also the main task of CPU1 (APP CPU) </p>

</div>
</div>
<a id="a67371293d974b9087bcb16643de878f0" name="a67371293d974b9087bcb16643de878f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67371293d974b9087bcb16643de878f0">&#9670;&nbsp;</a></span>initScientisst()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initScientisst </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>scientisst-firmware main function </p>
<p >Creates Mutex, initializes nvs, loads op_settings from flash, initializes wifi, bluetooth, adc, i2c etc. If pin 1 is enabled, enters config mode. If wifi mode, tries to connect to wifi network. If connection is unsuccessful, enter config mode. Either start web server (config mode), TCP server (wifi mode) or bluetooth. Starts send data task, adc task and adcExt task. If wifi start rcv task; else, start battery task (adc2) task. </p>

</div>
</div>
<a id="aaef0ef3b74ab2d2e8e833c961fdade79" name="aaef0ef3b74ab2d2e8e833c961fdade79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaef0ef3b74ab2d2e8e833c961fdade79">&#9670;&nbsp;</a></span>opModeConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void opModeConfig </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Puts the device in config mode. </p>
<p >This function puts the device in config mode. It initializes the rest server and turns on the state led (white). </p>

</div>
</div>
<a id="a65b2d1da040aa03eb6bc55ff6495ea2f" name="a65b2d1da040aa03eb6bc55ff6495ea2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65b2d1da040aa03eb6bc55ff6495ea2f">&#9670;&nbsp;</a></span>rcvTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rcvTask </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task that receives data from the client. </p>
<p >This task is responsible for receiving data from the client. </p>

</div>
</div>
<a id="af8d99f5f9f4ad067020fb6e4f3157c66" name="af8d99f5f9f4ad067020fb6e4f3157c66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8d99f5f9f4ad067020fb6e4f3157c66">&#9670;&nbsp;</a></span>sendTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IRAM_ATTR sendTask </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task that sends data to the client. </p>
<p >This task is responsible for sending data to the client. It is notified by the acqAdc1Task when there is data to send. If the client is BT or BLE it initializes the respective component.</p>
<p >This task can be removed and acqAdc1Task can do the <a class="el" href="bt_8c.html#a09adbbe03bca19d08be8cc4f256e7cc9" title="Function to send data using the appropriate send function.">sendData()</a> when !send_busy. But, atm acqAdc1Task is the bottleneck </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="adf58f1ea0e678533fafefedcba16ce39" name="adf58f1ea0e678533fafefedcba16ce39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf58f1ea0e678533fafefedcba16ce39">&#9670;&nbsp;</a></span>acq_curr_buff</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t acq_curr_buff</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">    0</div>
</div><!-- fragment -->
<p>Index of the buffer that adc task is currently using. </p>

</div>
</div>
<a id="aa96057547878820ef99184651491fa49" name="aa96057547878820ef99184651491fa49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa96057547878820ef99184651491fa49">&#9670;&nbsp;</a></span>active_ext_chs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t active_ext_chs[EXT_ADC_CHANNELS]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    0, 0}</div>
</div><!-- fragment -->
<p>Active external channels | If all channels are active: = {7, 6}. </p>

</div>
</div>
<a id="a3a07a97b62df36dc9cd67e6a56bb00b2" name="a3a07a97b62df36dc9cd67e6a56bb00b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a07a97b62df36dc9cd67e6a56bb00b2">&#9670;&nbsp;</a></span>active_internal_chs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t active_internal_chs[DEFAULT_ADC_CHANNELS]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    0, 0, 0, 0,</div>
<div class="line">    0, 0}</div>
</div><!-- fragment --><p >Active internal channels | If all channels are active: = {5, 4, 3, 2, 1, 0} </p>

</div>
</div>
<a id="ae18476f0aa11096ed565a85ebfc90507" name="ae18476f0aa11096ed565a85ebfc90507"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae18476f0aa11096ed565a85ebfc90507">&#9670;&nbsp;</a></span>adc_ext_samples</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t adc_ext_samples[EXT_ADC_CHANNELS]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    0, 0}</div>
</div><!-- fragment --><p >Samples from external adc get stored here before being incorporated into frame </p>

</div>
</div>
<a id="a4f17a0b46a4710620873bdfc4bfb8f5c" name="a4f17a0b46a4710620873bdfc4bfb8f5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f17a0b46a4710620873bdfc4bfb8f5c">&#9670;&nbsp;</a></span>analog_channels</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DRAM_ATTR const uint8_t analog_channels[DEFAULT_ADC_CHANNELS]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    <a class="code hl_define" href="adc_8h.html#aa913153b2d4286275aa01b98edec87be">A0_ADC_CH</a>, <a class="code hl_define" href="adc_8h.html#a7682706ef4d50ac852a854ddcd377546">A1_ADC_CH</a>, <a class="code hl_define" href="adc_8h.html#adf4e4b55cace5a07c623faf082e88493">A2_ADC_CH</a>, <a class="code hl_define" href="adc_8h.html#a04ca35942754279fd083f7b95df93f4c">A3_ADC_CH</a>, <a class="code hl_define" href="adc_8h.html#ae121004b8a19755804222c03e8feef51">A4_ADC_CH</a>, <a class="code hl_define" href="adc_8h.html#a41848687121e6e16a1c8e0cbf461371d">A5_ADC_CH</a>}</div>
<div class="ttc" id="aadc_8h_html_a04ca35942754279fd083f7b95df93f4c"><div class="ttname"><a href="adc_8h.html#a04ca35942754279fd083f7b95df93f4c">A3_ADC_CH</a></div><div class="ttdeci">#define A3_ADC_CH</div><div class="ttdoc">AI4, GPIO33.</div><div class="ttdef"><b>Definition:</b> adc.h:37</div></div>
<div class="ttc" id="aadc_8h_html_a41848687121e6e16a1c8e0cbf461371d"><div class="ttname"><a href="adc_8h.html#a41848687121e6e16a1c8e0cbf461371d">A5_ADC_CH</a></div><div class="ttdeci">#define A5_ADC_CH</div><div class="ttdoc">AI6, GPIO35.</div><div class="ttdef"><b>Definition:</b> adc.h:39</div></div>
<div class="ttc" id="aadc_8h_html_a7682706ef4d50ac852a854ddcd377546"><div class="ttname"><a href="adc_8h.html#a7682706ef4d50ac852a854ddcd377546">A1_ADC_CH</a></div><div class="ttdeci">#define A1_ADC_CH</div><div class="ttdoc">AI2, GPIO39.</div><div class="ttdef"><b>Definition:</b> adc.h:35</div></div>
<div class="ttc" id="aadc_8h_html_aa913153b2d4286275aa01b98edec87be"><div class="ttname"><a href="adc_8h.html#aa913153b2d4286275aa01b98edec87be">A0_ADC_CH</a></div><div class="ttdeci">#define A0_ADC_CH</div><div class="ttdoc">AI1, GPIO36.</div><div class="ttdef"><b>Definition:</b> adc.h:34</div></div>
<div class="ttc" id="aadc_8h_html_adf4e4b55cace5a07c623faf082e88493"><div class="ttname"><a href="adc_8h.html#adf4e4b55cace5a07c623faf082e88493">A2_ADC_CH</a></div><div class="ttdeci">#define A2_ADC_CH</div><div class="ttdoc">AI3, GPIO32.</div><div class="ttdef"><b>Definition:</b> adc.h:36</div></div>
<div class="ttc" id="aadc_8h_html_ae121004b8a19755804222c03e8feef51"><div class="ttname"><a href="adc_8h.html#ae121004b8a19755804222c03e8feef51">A4_ADC_CH</a></div><div class="ttdeci">#define A4_ADC_CH</div><div class="ttdoc">AI5, GPIO34.</div><div class="ttdef"><b>Definition:</b> adc.h:38</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6369df7f65a4b328aa3de63c2f6be78" name="ae6369df7f65a4b328aa3de63c2f6be78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6369df7f65a4b328aa3de63c2f6be78">&#9670;&nbsp;</a></span>api_config</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structApi__Config.html">Api_Config</a> api_config</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {.api_mode = API_MODE_BITALINO,</div>
<div class="line">                         .aquire_func = &amp;<a class="code hl_function" href="adc_8c.html#ae282beb7d585ba638646550306526752">acquireAdc1Channels</a>,</div>
<div class="line">                         .select_ch_mask_func = &amp;<a class="code hl_function" href="com_8c.html#aac2378909bc99c264f31dc8db49d6e0d">selectChsFromMask</a>}</div>
<div class="ttc" id="aadc_8c_html_ae282beb7d585ba638646550306526752"><div class="ttname"><a href="adc_8c.html#ae282beb7d585ba638646550306526752">acquireAdc1Channels</a></div><div class="ttdeci">void acquireAdc1Channels(uint8_t *frame)</div><div class="ttdoc">acquire adc1 channels</div><div class="ttdef"><b>Definition:</b> adc.c:137</div></div>
<div class="ttc" id="acom_8c_html_aac2378909bc99c264f31dc8db49d6e0d"><div class="ttname"><a href="com_8c.html#aac2378909bc99c264f31dc8db49d6e0d">selectChsFromMask</a></div><div class="ttdeci">void selectChsFromMask(uint8_t *buff)</div><div class="ttdoc">Selects the active channels.</div><div class="ttdef"><b>Definition:</b> com.c:288</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acfaf9589d576b3fc0786f581b20bc19e" name="acfaf9589d576b3fc0786f581b20bc19e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfaf9589d576b3fc0786f581b20bc19e">&#9670;&nbsp;</a></span>bt_buffs_to_send</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t bt_buffs_to_send[NUM_BUFFERS]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div>
<div class="line">    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div>
<div class="line">    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}</div>
</div><!-- fragment --><p >If element 0 is set to 1, bt task has to send snd_buff[0] </p>

</div>
</div>
<a id="a8607928ef2ef25e6de81c163efc5f806" name="a8607928ef2ef25e6de81c163efc5f806"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8607928ef2ef25e6de81c163efc5f806">&#9670;&nbsp;</a></span>bt_curr_buff</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t bt_curr_buff</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">    0</div>
</div><!-- fragment -->
<p>Index of the buffer that bt task is currently sending. </p>

</div>
</div>
<a id="a649e81573a3aad33548e7f8c21700ada" name="a649e81573a3aad33548e7f8c21700ada"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a649e81573a3aad33548e7f8c21700ada">&#9670;&nbsp;</a></span>crc_table</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DRAM_ATTR const uint8_t crc_table[16]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {0,  3, 6,  5,  12, 15, 10, 9,</div>
<div class="line">                                         11, 8, 13, 14, 7,  4,  1,  2}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a304133f917e93ba96a348df51387dc92" name="a304133f917e93ba96a348df51387dc92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a304133f917e93ba96a348df51387dc92">&#9670;&nbsp;</a></span>is_op_settings_valid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t is_op_settings_valid = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >&lt; Struct that holds the wifi acquisition configuration (e.g. SSID, password, sample rate...) Flag that indicates if a valid op_settings has been read successfuly from flash </p>

</div>
</div>
<a id="aec948fb30e99b1eda7e3d9ff741d417a" name="aec948fb30e99b1eda7e3d9ff741d417a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec948fb30e99b1eda7e3d9ff741d417a">&#9670;&nbsp;</a></span>op_mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t op_mode = OP_MODE_IDLE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Flag that indicastes if op mode is on (idle, live or config) </p>

</div>
</div>
<a id="ad24c7510f51acaac27b62d21c280b747" name="ad24c7510f51acaac27b62d21c280b747"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad24c7510f51acaac27b62d21c280b747">&#9670;&nbsp;</a></span>op_settings</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structop__settings__info__t.html">op_settings_info_t</a> op_settings</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .com_mode = COM_MODE_SD_CARD,</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aee3ef59ff651fe7e6a9c273affdd5d5a" name="aee3ef59ff651fe7e6a9c273affdd5d5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee3ef59ff651fe7e6a9c273affdd5d5a">&#9670;&nbsp;</a></span>packet_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t packet_size</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">    0</div>
</div><!-- fragment -->
<p>Current packet size (dependent on number of channels used) </p>

</div>
</div>
<a id="aba2be5e3b1baddd09080812b975bf2fc" name="aba2be5e3b1baddd09080812b975bf2fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba2be5e3b1baddd09080812b975bf2fc">&#9670;&nbsp;</a></span>send_threshold</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t send_threshold</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">    MAX_BUFFER_SIZE</div>
</div><!-- fragment --><p >Amount of bytes a buffer needs to have filled with packets in order to trigger a send </p>

</div>
</div>
<a id="a00b1975a55c7817b061a797e43c45aff" name="a00b1975a55c7817b061a797e43c45aff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00b1975a55c7817b061a797e43c45aff">&#9670;&nbsp;</a></span>sin10Hz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t sin10Hz[100]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    31, 33, 35, 37, 39, 41, 42, 44, 46, 48, 49, 51, 52, 54, 55, 56, 57,</div>
<div class="line">    58, 59, 60, 60, 61, 61, 62, 62, 62, 62, 62, 61, 61, 60, 60, 59, 58,</div>
<div class="line">    57, 56, 55, 54, 52, 51, 49, 48, 46, 44, 42, 41, 39, 37, 35, 33, 31,</div>
<div class="line">    29, 27, 25, 23, 21, 20, 18, 16, 14, 13, 11, 10, 8,  7,  6,  5,  4,</div>
<div class="line">    3,  2,  2,  1,  1,  0,  0,  0,  0,  0,  1,  1,  2,  2,  3,  4,  5,</div>
<div class="line">    6,  7,  8,  10, 11, 13, 14, 16, 18, 20, 21, 23, 25, 27, 29}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2b4deaf1aa96b3b76c622733874f9ef" name="ac2b4deaf1aa96b3b76c622733874f9ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2b4deaf1aa96b3b76c622733874f9ef">&#9670;&nbsp;</a></span>snd_buff</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* snd_buff[NUM_BUFFERS]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Data structure to hold the data to be sent through bluetooth </p>

</div>
</div>
<a id="abb1e90d26548b840cbbae672eb63c0d7" name="abb1e90d26548b840cbbae672eb63c0d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb1e90d26548b840cbbae672eb63c0d7">&#9670;&nbsp;</a></span>snd_buff_idx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t snd_buff_idx[NUM_BUFFERS]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div>
<div class="line">    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div>
<div class="line">    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}</div>
</div><!-- fragment --><p >It contains, for each buffer, the index of the first free element in the respective buffer </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
